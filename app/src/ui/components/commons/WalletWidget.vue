<script setup lang="ts">
import { useClientStore } from '~/stores/client'
import { formatAddress } from '~/shared'
import { ChainClient } from '~/network/Chain'
// import { useClientStore } from '~/stores/client'
// import { microDenomToDenom } from '~/utils/denom'
// import { formatAmount } from '~/shared'
// const client = useClientStore()
// const acceptedBalance = computed(() => client.acceptedTokenBalance)
// const receivedBalance = computed(() => client.receivedTokenBalance)

// function formatDenom(denom: string): string {
//   return microDenomToDenom(denom)
// }

const client = useClientStore()
const userWallet = computed(() => client.userWallet)

const finder = computed(() => {
  if (client.chainClient === ChainClient.kujiraMainnet) {
    return `kaiyo-1/address/${userWallet.value.address}`
  } else {
    return `harpoon-4/address/${userWallet.value.address}`
  }
})

const widgetActive = ref(false)
function toggleWidget() {
  widgetActive.value = !widgetActive.value
}
defineExpose({ toggleWidget })
</script>

<template>
  <div v-if="widgetActive" class="widget">
    <div class="wrap">
      <div class="header">
        <div class="inner">
          <p class="title">My Wallet</p>
          <p class="address">{{ formatAddress(userWallet.address) }}</p>
        </div>
        <div class="actions">
          <a :href="`https://finder.kujira.app/${finder}`" target="_blank" alt="Finder link">
            <svg
              class="icon-24"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                d="M18 13V19C18 19.5304 17.7893 20.0391 17.4142 20.4142C17.0391 20.7893 16.5304 21 16 21H5C4.46957 21 3.96086 20.7893 3.58579 20.4142C3.21071 20.0391 3 19.5304 3 19V8C3 7.46957 3.21071 6.96086 3.58579 6.58579C3.96086 6.21071 4.46957 6 5 6H11"
                stroke="inherit"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
              <path d="M15 3H21V9" stroke="inherit" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
              <path d="M10 14L21 3" stroke="inherit" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
            </svg>
          </a>
        </div>
      </div>
      <div class="separator"></div>
      <!-- <div class="balance">
        <p class="label">{{ formatDenom(receivedBalance.denom) }}</p>
        <p class="balance">{{ formatAmount(receivedBalance.amount) }}</p>
      </div> -->
      <div class="token-list">
        <div class="wrap-token">
          <div class="token">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M19.7557 12.0001C19.7557 16.2836 16.2829 19.7561 11.999 19.7561C7.71514 19.7561 4.24237 16.2836 4.24237 12.0001C4.24237 7.71655 7.71514 4.24405 11.999 4.24405C16.2829 4.24405 19.7557 7.71655 19.7557 12.0001Z"
                fill="url(#paint0_linear_1119_6936)"
              />
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M23.9232 13.3558C23.8683 13.8384 23.4049 14.1522 22.9276 14.0622C22.4503 13.9721 22.1403 13.5122 22.1891 13.0289C22.3105 11.827 22.2185 10.6108 21.915 9.43677C21.6114 8.26276 21.1024 7.15429 20.4137 6.16182C20.1368 5.76276 20.185 5.21027 20.5588 4.90017C20.9327 4.59007 21.4901 4.64001 21.772 5.03555C22.6232 6.22974 23.2497 7.57196 23.618 8.99653C23.9863 10.4211 24.0888 11.8988 23.9232 13.3558Z"
                fill="white"
              />
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M18.8698 2.1613C19.2681 2.43937 19.3234 2.99622 19.0168 3.37302C18.7103 3.74982 18.1583 3.80332 17.7566 3.53028C17.1678 3.13013 16.5389 2.79244 15.8801 2.5227C15.4306 2.33865 15.1703 1.84894 15.3152 1.38532C15.46 0.921707 15.9548 0.660231 16.4066 0.838613C17.2764 1.18203 18.1031 1.62595 18.8698 2.1613Z"
                fill="white"
              />
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M12.3927 0.00646447C12.8782 0.022407 13.2283 0.459031 13.1768 0.942009C13.1254 1.42499 12.6918 1.77084 12.2061 1.76101C10.2443 1.72131 8.3116 2.2463 6.63954 3.2731C6.22561 3.52729 5.6766 3.44836 5.38784 3.05779C5.09908 2.66722 5.18009 2.1135 5.59078 1.85412C7.62172 0.571448 9.99188 -0.0723751 12.3927 0.00646447Z"
                fill="white"
              />
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M2.57501 4.57036C2.87576 4.18895 3.43493 4.16607 3.79333 4.49391C4.15173 4.82175 4.1731 5.37593 3.87718 5.76111C3.23561 6.59617 2.72666 7.52525 2.36833 8.51546C2.20305 8.97218 1.72452 9.25255 1.25526 9.12707C0.786004 9.00159 0.504225 8.51811 0.66374 8.05934C1.10225 6.79815 1.74825 5.6189 2.57501 4.57036Z"
                fill="white"
              />
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M0.000136656 12.2176C-0.00867179 11.732 0.409589 11.3602 0.894597 11.387C1.3796 11.4138 1.74712 11.8291 1.76204 12.3146C1.78093 12.9292 1.85514 13.5409 1.98376 14.1422C2.08537 14.6171 1.82783 15.1083 1.3633 15.2503C0.898761 15.3922 0.40373 15.1312 0.296156 14.6576C0.114228 13.8565 0.0150334 13.0389 0.000136656 12.2176Z"
                fill="white"
              />
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M1.85725 18.4156C1.59756 18.0051 1.76196 17.4702 2.19037 17.2413C2.61879 17.0123 3.14857 17.1765 3.4134 17.5837C4.58484 19.3848 6.2982 20.7787 8.31701 21.5564C10.3358 22.3342 12.5416 22.4501 14.6188 21.9005C15.0883 21.7763 15.5914 22.0099 15.7554 22.4671C15.9195 22.9243 15.6824 23.4312 15.2144 23.5613C12.7382 24.25 10.0975 24.1273 7.68461 23.1977C5.27178 22.2682 3.23132 20.5875 1.85725 18.4156Z"
                fill="white"
              />
              <path
                fill-rule="evenodd"
                clip-rule="evenodd"
                d="M18.9104 21.8104C18.5132 22.0901 17.9708 21.9524 17.7209 21.5359C17.471 21.1194 17.6087 20.5822 18.0023 20.2975C19.3063 19.3542 20.3699 18.1166 21.1062 16.6855C21.3284 16.2536 21.8389 16.0366 22.2883 16.221C22.7377 16.4053 22.9554 16.9209 22.7386 17.3555C21.8514 19.1345 20.5357 20.6655 18.9104 21.8104Z"
                fill="white"
              />
              <defs>
                <linearGradient
                  id="paint0_linear_1119_6936"
                  x1="5.17852"
                  y1="5.09097"
                  x2="18.9968"
                  y2="17.885"
                  gradientUnits="userSpaceOnUse"
                >
                  <stop stop-color="#FBA367" />
                  <stop offset="1" stop-color="#EF6100" />
                </linearGradient>
              </defs>
            </svg>

            <p class="denom">LOCAL</p>
          </div>

          <p class="amount">$34,000.854</p>
        </div>
      </div>
      <div class="wrap-btn">
        <button class="secondary bg-gray300 center-text" @click="$emit('connectWidget')">disconnect</button>
      </div>
    </div>
  </div>

  <div v-if="widgetActive" class="widget-close" @click="toggleWidget" />
</template>

<style lang="scss" scoped>
@import '../../style/tokens.scss';

.widget {
  position: absolute;
  right: 0;
  top: 64px;
  z-index: $z-level-3;
  background-color: $surface;
  border: 1px solid $border;
  border-radius: 8px;
  box-shadow: 0px 2px 25px rgba(0, 0, 0, 0.2);

  .wrap {
    min-width: 350px;
    display: flex;
    flex-direction: column;

    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 16px;
      .inner {
        .title {
          font-size: 18px;
          font-weight: $semi-bold;
        }
        .address {
          font-size: 14px;
          color: $gray700;
        }
      }
      .actions {
        svg {
          width: 20px;
          height: 20px;
          stroke: $gray700;
        }
      }
    }

    .separator {
      width: 100%;
      height: 1px;
      background-color: $border;
      margin: 16px 0;
    }

    .token-list {
      display: flex;
      flex-direction: column;
      margin: 8px 0 24px;

      .wrap-token {
        display: flex;
        justify-content: space-between;
        .token {
          display: flex;
          gap: 8px;

          .denom {
            font-weight: $semi-bold;
          }
        }
        .amount {
          font-weight: $semi-bold;
        }
      }
    }

    .wrap-btn {
      margin: 8px 0 24px;
      button {
        width: 100%;
      }
    }
    .header,
    .token-list,
    .wrap-btn {
      padding: 0 24px;
    }
  }
}
.widget-close {
  position: fixed;
  width: 100%;
  height: 100vh;
  left: 0;
  top: 0;
  z-index: 99;
}
</style>
